<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Budget Page</title>

  <!-- Tailwind (keep as you had it) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Small local styles kept from your original file */
    :root{
      --fg:#0f172a; --muted:#6b7280; --muted-2:#9ca3af;
      --border:#e5e7eb; --surface:#ffffff; --primary:#16a34a;
      --primary-700:#15803d; --primary-100:#dcfce7;
      --shadow:0 1px 2px rgba(0,0,0,.06), 0 8px 24px rgba(2,6,23,.06);
      --radius:16px;
    }
    .hero{ background: linear-gradient(180deg,#f0fdf4,#f7fff8); font-family: Helvetica, sans-serif; }
    .hero h1{ font-size:40px; line-height:1.2; font-weight:800; margin-top:12px; color:var(--fg); }
    .badge{ display:inline-flex; align-items:center; font-size:14px; border:1px solid rgba(22,163,74,.25); padding:4px 12px; border-radius:999px; background:var(--primary-100); color:var(--primary); font-weight:500; }
    .stat-card{ background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); }
    .hero-img{ border-radius:var(--radius); box-shadow:var(--shadow); }
  </style>
</head>

<body class="min-h-screen bg-white-50 font-sans text-gray-900">

  <!-- global header (moved into body so fetch target exists) -->
  <div id="global-header"></div>
  <script>
    // change the filename depending on the page/user state
    const headerType = "header-2"; // "header-2" or "header-3"
    fetch(`/header/${headerType}.html`)
      .then(res => res.text())
      .then(html => { document.querySelector("#global-header").innerHTML = html; })
      .catch(() => {/* fail silently */});
  </script>

  <!-- Hero -->
  <section class="hero py-16 px-6 lg:px-8">
    <div class="max-w-7xl mx-auto grid lg:grid-cols-2 gap-12 items-center">
      <div>
        <span class="badge">💰 Smart Budget Tracking</span>
        <h1>Master Your <span style="color:var(--primary)">Grocery Budget</span></h1>
        <p class="mb-6">Track every dollar, analyze spending patterns, and discover smart ways to save while maintaining a healthy and delicious meal plan.</p>

        <div class="grid grid-cols-2 gap-4">
          <div class="stat-card">
            <div class="stat-title">💵 <span>This Month</span></div>
            <p id="totalSpentVal" class="stat-value">—</p>
            <p id="pctOfBudget" class="stat-sub">—</p>
          </div>

          <div class="stat-card">
            <div class="stat-title">🎯 <span>Saved</span></div>
            <p id="savedVal" class="stat-value">—</p>
            <p id="savedSub" class="stat-sub">—</p>
          </div>
        </div>
      </div>

     <!--- DASHBOARD CARD START -->
      <!-- REPLACE your <div><img ... /></div> with this block -->
<div id="budget-chart-wrapper" style="width:100%;">
  <style>
    /* local styles so this block behaves like an image placeholder */
    #budget-chart-card{
      background: #fff;
      border: 1px solid #e0e3e6;
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 6px 20px rgba(15,23,42,0.04);
      width: 100%;
      box-sizing: border-box;
    }
    #budget-chart-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#1f2937;
    }
    #budget-chart-canvas-wrap{
      height: 320px; /* matches visual height of your hero image area */
      width: 100%;
    }
    /* make canvas fill the card */
    #budgetChart { width:100% !important; height:100% !important; display:block; }
  </style>

  <!-- card that visually replaces the image -->
  <div id="budget-chart-card" role="region" aria-label="Monthly chart">
    <div id="budget-chart-header">
      <div style="font-weight:600; font-size:15px;">Monthly values</div>
      <div style="font-size:12px; color:#6b7280;">Bars = monthly • Line = trend</div>
    </div>

    <div id="budget-chart-canvas-wrap">
      <canvas id="budgetChart"></canvas>
    </div>
  </div>

  <!-- Chart.js CDN (only include once on the page) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    (function(){
      // If Chart already loaded on page, don't error out.
      if (typeof Chart === 'undefined') {
        console.warn('Chart.js not loaded.');
      }

      const labels = ['January', 'February', 'March', 'April', 'May', 'June'];
      const barValues = [700, 1050, 1500, 1400, 1600, 2050];   // approximated
      const lineValues = [1250, 1600, 2200, 1700, 1250, 1900]; // approximated

      function hexToRgba(hex, a = 1){
        const bigint = parseInt(hex.replace('#',''), 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return `rgba(${r}, ${g}, ${b}, ${a})`;
      }

      const barColor = '#12B981';
      const lineColor = '#d993a6';

      const ctx = document.getElementById('budgetChart').getContext('2d');

      // Destroy existing chart on same canvas (if re-rendering)
      if (ctx.__chartInstance) {
        try { ctx.__chartInstance.destroy(); } catch(e){/*ignore*/ }
      }

      ctx.__chartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              type: 'bar',
              label: 'Monthly',
              data: barValues,
              backgroundColor: barColor,
              borderRadius: 8,
              borderSkipped: false,
              barThickness: 'flex',
              maxBarThickness: 56
            },
            {
              type: 'line',
              label: 'Trend',
              data: lineValues,
              tension: 0.25,
              borderColor: lineColor,
              backgroundColor: hexToRgba(lineColor, 0.06),
              pointBackgroundColor: lineColor,
              pointBorderColor: '#fff',
              pointRadius: 4,
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: 'index', intersect: false },
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const v = context.parsed.y ?? context.parsed;
                  return (context.dataset.type === 'bar' ? ' $' : ' $') + v.toLocaleString();
                }
              }
            }
          },
          scales: {
            x: {
              grid: { display: false },
              ticks: { color: '#4b5563', padding: 6 }
            },
            y: {
              beginAtZero: true,
              suggestedMax: 2250,
              ticks: {
                stepSize: 250,
                callback: function(value) { return '$' + value; },
                color: '#4b5563',
                padding: 6
              },
              grid: { color: '#e9ecef', borderDash: [3,3], drawBorder: false }
            }
          }
        }
      });
    })();
  </script>
</div>

      <!--- DASHBOARD END -->
      </div>

      
  <!-- Overview Cards -->
  <section class="py-12 px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
        <!-- Card 1 -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">💵</div>
            <span id="pctChangeBadge" class="bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded-full text-xs">—</span>
          </div>
          <h3 id="cardTotalSpent" class="text-2xl font-bold">—</h3>
          <p class="text-sm text-green-800/80">Total Spent This Month</p>
          <div class="w-full bg-green-200 h-2 rounded mt-3">
            <div id="budgetProgressBar" class="bg-green-600 h-2 rounded" style="width:0%"></div>
          </div>
          <p id="budgetPctText" class="text-xs text-green-700 mt-1">—</p>
        </div>

        <!-- Card 2 -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">🎯</div>
            <span id="onTrackBadge" class="bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded-full text-xs">—</span>
          </div>
          <h3 id="avgPerWeek" class="text-2xl font-bold">—</h3>
          <p class="text-sm text-green-800/80">Average Per Week</p>
          <div class="mt-3 text-xs text-green-800/70 flex justify-between">
            <span id="weeklyBudgetLabel">Weekly Budget: —</span>
            <span id="weeklyStatus" class="text-green-700">—</span>
          </div>
        </div>

        <!-- Card 3 -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">📈</div>
            <span id="savedBadge" class="bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded-full text-xs">—</span>
          </div>
          <h3 id="moneySaved" class="text-2xl font-bold">—</h3>
          <p class="text-sm text-green-800/80">Money Saved</p>
          <p id="savedNote" class="text-xs text-green-700 mt-3">—</p>
        </div>

        <!-- Card 4 -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">🛒</div>
            <span id="tripCountBadge" class="bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded-full text-xs">—</span>
          </div>
          <h3 id="avgPerTrip" class="text-2xl font-bold">—</h3>
          <p class="text-sm text-green-800/80">Avg Per Shopping Trip</p>
          <p id="tripsNote" class="text-xs text-green-800/70 mt-3">—</p>
        </div>
      </div>

      <!-- Weekly Breakdown & Category Breakdown -->
      <div class="grid lg:grid-cols-2 gap-8 mb-12">
        <!-- Weekly Spending -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <h3 class="text-lg font-semibold mb-2">📊 Weekly Spending Breakdown</h3>
          <p class="text-sm text-green-800/70 mb-4">Track your spending patterns throughout the month</p>

          <div class="space-y-4">
            <div>
              <div class="flex justify-between text-sm">
                <span class="font-medium">Week 1</span>
                <span class="text-green-800">
                  <span id="week1Amount">—</span>
                  <span id="week1PctBadge" class="bg-green-100 text-green-700 px-1 rounded text-xs">—</span>
                </span>
              </div>
              <div class="w-full bg-green-200 h-2 rounded mt-1">
                <div id="week1Bar" class="bg-green-600 h-2 rounded" style="width:0%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between text-sm">
                <span class="font-medium">Week 2</span>
                <span class="text-green-800">
                  <span id="week2Amount">—</span>
                  <span id="week2PctBadge" class="bg-red-100 text-red-700 px-1 rounded text-xs">—</span>
                </span>
              </div>
              <div class="w-full bg-green-200 h-2 rounded mt-1">
                <div id="week2Bar" class="bg-red-500 h-2 rounded" style="width:0%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between text-sm">
                <span class="font-medium">Week 3</span>
                <span class="text-green-800">
                  <span id="week3Amount">—</span>
                  <span id="week3PctBadge" class="bg-green-100 text-green-700 px-1 rounded text-xs">—</span>
                </span>
              </div>
              <div class="w-full bg-green-200 h-2 rounded mt-1">
                <div id="week3Bar" class="bg-green-600 h-2 rounded" style="width:0%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between text-sm">
                <span class="font-medium">Week 4</span>
                <span class="text-green-800">
                  <span id="week4Amount">—</span>
                  <span id="week4PctBadge" class="bg-red-100 text-red-700 px-1 rounded text-xs">—</span>
                </span>
              </div>
              <div class="w-full bg-green-200 h-2 rounded mt-1">
                <div id="week4Bar" class="bg-red-500 h-2 rounded" style="width:0%"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Spending by Category -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <h3 class="text-lg font-semibold mb-2">🥗 Spending by Category</h3>
          <p class="text-sm text-green-800/70 mb-4">See where your grocery budget goes</p>

          <div id="categoriesList" class="space-y-3">
            <div class="text-sm muted">No category data yet</div>
          </div>
        </div>
      </div>

      <!-- compact lower wrapper for transactions and tips -->
      <div class="max-w-5xl mx-auto p-6 space-y-6">
        <!-- Recent Transactions -->
        <div class="border border-green-200 rounded-xl bg-white p-6">
          <h3 class="text-lg font-semibold mb-2">⏰ Recent Transactions</h3>
          <p class="text-sm text-green-800/70 mb-4">Your latest grocery purchases and spending</p>

          <div id="recentTransactions" class="space-y-4">
            <div class="text-sm text-gray-500">No transactions yet</div>
          </div>

          <div class="text-center mt-6">
            <button class="px-4 py-2 border border-green-300 rounded-lg text-green-700 hover:bg-green-100">View All Transactions</button>
          </div>
        </div>

        <!-- Savings Tips -->
        <div class="border-2 border-green-300 rounded-xl bg-white p-6 shadow">
          <h3 class="text-lg font-semibold mb-2">🎯 Smart Savings Tips</h3>
          <p class="text-sm text-green-800/70 mb-6">Personalized recommendations to optimize your grocery budget</p>

          <div class="grid md:grid-cols-3 gap-6">
            <div class="space-y-3 p-4 bg-green-50 rounded-2xl">
              <div class="flex justify-between">
                <h4 class="font-semibold">Switch to seasonal produce</h4>
                <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">Easy</span>
              </div>
              <p class="text-sm text-green-800/80">Save 15–20% by choosing in-season vegetables and fruits.</p>
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-green-700">$12–15/week</span>
                <button class="px-3 py-1 border border-green-300 rounded text-green-700 hover:bg-green-100 text-sm">Try This</button>
              </div>
            </div>

            <div class="space-y-3 p-4 bg-green-50 rounded-2xl">
              <div class="flex justify-between">
                <h4 class="font-semibold">Buy generic brands</h4>
                <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">Easy</span>
              </div>
              <p class="text-sm text-green-800/80">Generic staples can save you up to 30% without compromising quality.</p>
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-green-700">$8–12/week</span>
                <button class="px-3 py-1 border border-green-300 rounded text-green-700 hover:bg-green-100 text-sm">Try This</button>
              </div>
            </div>

            <div class="space-y-3 p-4 bg-green-50 rounded-2xl">
              <div class="flex justify-between">
                <h4 class="font-semibold">Meal prep on Sundays</h4>
                <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">Medium</span>
              </div>
              <p class="text-sm text-green-800/80">Batch cook staples to avoid takeout and reduce food waste — freeze portions for quick meals.</p>
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-green-700">$5–10/week</span>
                <button class="px-3 py-1 border border-green-300 rounded text-green-700 hover:bg-green-100 text-sm">Try This</button>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- end lower wrapper -->

    </div> <!-- end max-w-7xl -->
  </section>

  <!-- Footer (outside all wrappers so it can be full-width) -->
  <footer id="footer" class="mt-12 w-full text-right"></footer>
  <script>
    fetch("/footer/index.html")
      .then(res => res.text())
      .then(html => document.getElementById("footer").innerHTML = html)
      .catch(() => {});
  </script>

  <!-- Main client-side module (adjust path as needed) -->
  <script type="module" src="/statistics/statistics.js"></script>
</body>
</html>
